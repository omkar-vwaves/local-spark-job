{
    "DOMAIN":"${domain}",
    "VENDOR":"${vendor}",
    "TECHNOLOGY":"${technology}",
    "EMS_TYPE":"${emsType}",
    "NE_TYPE":"${neTypes}",
    "FREQUENCY":"${frequency}",
    "BASE_TRINO_ORC_PATH_DATE":"${baseTrinoOrcPathDate}",
    "BASE_TRINO_ORC_PATH_TIME":"${baseTrinoOrcPathTime}",
    "BASE_TRINO_ORC_PATH":"${baseTrinoOrcPath}",
    "BASE_TRINO_NE_PATH_DATE":"${baseTrinoNePathDate}",
    "BASE_TRINO_NE_PATH_TIME":"${baseTrinoNePathTime}",
    "BASE_TRINO_NE_PATH":"${baseTrinoNePath}",
    "TIMESTAMP":"${timestamp}"
}


SELECT 
    "${DOMAIN}" AS DOMAIN,
    "${VENDOR}" AS VENDOR,
    "${TECHNOLOGY}" AS TECHNOLOGY,
    "${EMS_TYPE}" AS EMS_TYPE,
    "${NE_TYPE}" AS NE_TYPE,
    "${FREQUENCY}" AS FREQUENCY,
    "${BASE_TRINO_ORC_PATH_DATE}" AS BASE_TRINO_ORC_PATH_DATE,
    "${BASE_TRINO_ORC_PATH_TIME}" AS BASE_TRINO_ORC_PATH_TIME,
    "${BASE_TRINO_ORC_PATH}" AS BASE_TRINO_ORC_PATH,
    "${BASE_TRINO_NE_PATH_DATE}" AS BASE_TRINO_NE_PATH_DATE,
    "${BASE_TRINO_NE_PATH_TIME}" AS BASE_TRINO_NE_PATH_TIME,
    "${BASE_TRINO_NE_PATH}" AS BASE_TRINO_NE_PATH,
    "${TIMESTAMP}" AS TIMESTAMP,
    "${SPARK_PM_JDBC_URL}" AS SPARK_PM_JDBC_URL,
    "${SPARK_PM_JDBC_DRIVER}" AS SPARK_PM_JDBC_DRIVER,
    "${SPARK_PM_JDBC_USERNAME}" AS SPARK_PM_JDBC_USERNAME,
    "${SPARK_PM_JDBC_PASSWORD}" AS SPARK_PM_JDBC_PASSWORD,
    "${SPARK_FM_JDBC_URL}" AS SPARK_FM_JDBC_URL,
    "${SPARK_FM_JDBC_DRIVER}" AS SPARK_FM_JDBC_DRIVER,
    "${SPARK_FM_JDBC_USERNAME}" AS SPARK_FM_JDBC_USERNAME,
    "${SPARK_FM_JDBC_PASSWORD}" AS SPARK_FM_JDBC_PASSWORD,
    "${SPARK_MINIO_ENDPOINT_URL}" AS SPARK_MINIO_ENDPOINT_URL,
    "${SPARK_MINIO_ACCESS_KEY}" AS SPARK_MINIO_ACCESS_KEY,
    "${SPARK_MINIO_SECRET_KEY}" AS SPARK_MINIO_SECRET_KEY,
    "${SPARK_MINIO_BUCKET_NAME_PM}" AS SPARK_MINIO_BUCKET_NAME_PM
FROM DUAL


SELECT PERFORMANCE_ALERT_ID_PK, CONFIGURATION, EXPRESSION, DOMAIN, VENDOR, NAME, DESCRIPTION, ALERTTYPE, ALERTID, TECHNOLOGY FROM PERFORMANCE_ALERT WHERE DOMAIN = '${DOMAIN}' AND VENDOR = '${VENDOR}' AND TECHNOLOGY = '${TECHNOLOGY}' AND UPPER( JSON_UNQUOTE( JSON_EXTRACT( REPLACE(REPLACE(CONFIGURATION, '"', ''), "'", '"'), '$.frequency[0]' ) ) ) = '${FREQUENCY}' AND DELETED = 0


SELECT * FROM ALARM_LIBRARY WHERE DELETED = 0 AND ENABLED = 1 AND DOMAIN = '${DOMAIN}' AND VENDOR = '${VENDOR}' AND TECHNOLOGY = '${TECHNOLOGY}' AND EMS_TYPE = 'PERFORMANCE_ALERT'



SELECT pa.PERFORMANCE_ALERT_ID_PK, pa.CONFIGURATION, pa.EXPRESSION, pa.DOMAIN, pa.VENDOR, pa.ALERTID, pa.NAME, pa.DESCRIPTION, pa.TECHNOLOGY, al.ALARM_IDENTIFIER, al.ALARM_NAME, al.CLASSIFICATION, al.NETYPE, al.DEFAULT_SEVERITY, al.EMS_TYPE, al.EVENT_TYPE, al.ALARM_ID, al.SERVICE_AFFECTING, al.CORRELATION_ENABLE, al.MANUAL_CLEARED, al.PROBABLE_CAUSE, al.PRIORITY, al.ALARM_LAYER, al.ALARM_GROUP, al.EQUIPMENT_TYPE, al.IS_SOUTH_BOUND_INTEGRATION FROM PERFORMANCE_ALERT pa JOIN ALARM_LIBRARY al ON pa.ALERTID = al.ALARM_IDENTIFIER



SELECT CONCAT(metaData['NAM'], COALESCE('', ''), '##', finalKey) AS finalKey, '$FILTER_QUERY_FINAL', metaData FROM rawFileNodeAggrData


SELECT finalKey, '$COUNTER_MAP_QUERY', metaData FROM timeAggrData


SELECT formula_calculated_data.record_data.* FROM ( SELECT KPIEvaluator(finalKey, rawcounters, metaData, 'QUARTERLY') AS record_data FROM finalAggrDataKPI WHERE finalKey IS NOT NULL AND finalKey != '-' AND finalKey != "" ) AS formula_calculated_data






